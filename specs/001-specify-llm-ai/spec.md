# Feature Specification: 로컬 CoT 데이터셋 생성/관리 관리자 웹앱

**Feature Branch**: `001-specify-llm-ai`  
**Created**: 2025-09-20  
**Status**: Draft  
**Input**: User description: "LLM AI모델 학습용 Chain Of Thought 데이터셋을 만들기 위한 로컬 PC 실행 관리 웹앱. 금융상품 추천 목적. 30만 질문자, 1만 금융상품, 1만 CoT 저장. 로그인 없음. 메뉴: CoTs, 설정, 질문자 리스트, 상품 리스트. CoTs 상세는 좌/중앙/우 패널 구조. 설정은 로컬 스토리지 저장. 모든 리스트: 검색/정렬/페이징, CSV/JSON Import/Export, 클릭 시 상세로 이동 및 수정/삭제 제공. 입력값 유효성 검사 필수."

## Execution Flow (main)
```
1. 사용자 설명(Input) 파싱
   → 비어 있으면: ERROR "No feature description provided"
2. 핵심 개념 추출
   → 식별: 사용자 유형, 주요 행위, 데이터 엔티티, 제약조건
3. 불명확 항목마다 표기
   → [NEEDS CLARIFICATION: 구체 질문]
4. 사용자 시나리오 & 테스트 작성
   → 명확한 플로우 없으면: ERROR "Cannot determine user scenarios"
5. 기능 요구사항 생성
   → 모든 요구사항은 테스트 가능해야 함
   → 모호한 요구사항은 표시
6. 핵심 엔티티 식별(데이터 포함 시)
7. 검토 체크리스트 수행
   → [NEEDS CLARIFICATION] 존재 시: WARN "Spec has uncertainties"
   → 구현 세부 포함 시: ERROR "Remove tech details"
8. 반환: SUCCESS (기획 준비 완료)
```

---

## ⚡ Quick Guidelines
- ✅ 사용자가 무엇을/왜 원하는지에 집중
- ❌ 구현 방법(스택, API, 코드 구조) 기재 금지
- 👥 비즈니스/기획 이해관계자 대상으로 작성

### Section Requirements
- **필수 섹션**: 모든 기능에 대해 작성
- **선택 섹션**: 관련될 때만 포함
- 적용되지 않는 섹션은 제거(“N/A”로 남기지 않음)

### For AI Generation
- 모든 모호점은 [NEEDS CLARIFICATION: 구체 질문]으로 표기
- 추측 금지. 명시되지 않은 요소는 표기
- 테스터 관점으로 작성: 테스트 가능/일의적 기준 확보
- 흔한 미정 항목 예시: 사용자 권한, 데이터 보존, 성능, 오류 처리, 통합, 보안/컴플라이언스

---

## User Scenarios & Testing (mandatory)

### Primary User Story
관리자는 로컬에서 실행되는 반응형 관리자 웹앱을 열어 CoT 데이터셋을 생성/검색/수정/삭제하고, 질문자 및 금융상품 데이터를 조회/선택하여 CoT를 풍부하게 작성한다. 설정에서 기본 작성자와 UI 환경(글꼴 크기, 라이트/다크 모드 등)을 지정하며, 모든 리스트에서 대용량 데이터를 효율적으로 검색/정렬/페이징하며 CSV/JSON으로 가져오기/내보내기를 수행한다.

### Acceptance Scenarios
1. Given 앱이 처음 실행됨, When 관리자가 "설정"에서 작성자 이름과 토글/슬라이더/모드를 조정 후 저장, Then 설정값이 로컬 스토리지에 저장되어 재접속 시 동일하게 적용된다.
2. Given CoTs 리스트 화면, When 텍스트/상품분류/질문유형/성별/연령 검색 후 정렬과 페이징으로 이동, Then 조건에 맞는 CoT 요약(상품분류, 질문유형, 성별, 연령대, 질문, 작성자, 등록일, 수정일)이 정확히 표시된다.
3. Given CoTs 상세 화면, When 왼쪽 패널에서 질문자를 검색 팝업으로 선택하고, 오른쪽 패널에서 복수 상품을 선택/아코디언으로 검토한 뒤 중앙 패널에서 CoT1~3(필수) 및 추가 CoTn과 답변/상태를 입력하고 저장, Then 유효성 검사를 통과하면 저장되고 리스트에 반영된다.
4. Given CoTs 상세 화면, When 항목 삭제를 클릭, Then 확인/취소 팝업이 표시되고 확인 시 항목이 삭제되며 리스트로 돌아간다.
5. Given 질문자 리스트 화면, When 상품분류/성별/연령대 필터로 검색하고 항목 클릭, Then 질문자 상세(성별, 연령대, 직업, 지역, 가족구성, 자산규모, 투자성향)가 한 눈에 보인다.
6. Given 상품 리스트 화면, When 상품분류/상품유형으로 검색하고 항목 클릭, Then 상품 상세(상품명, 상품출처, 상품분류, 운용사, 설정수익률, 위험등급)가 한 눈에 보인다.
7. Given 어떤 리스트 화면이든, When CSV 또는 JSON Import/Export를 수행, Then 데이터 형식 검증 후 성공/오류 결과가 표시되고 유효한 데이터는 반영된다.

### Edge Cases
- 필수 항목(CoT1~3, 질문, 질문유형, 상품출처 등) 미입력 시: 저장 불가 및 필드별 안내 메시지 표시
- 매우 긴 텍스트 입력(질문/CoT/답변): 길이 제한 및 안내 처리
- 대용량 데이터(질문자 30만, 상품 1만, CoT 1만) 검색/정렬/페이징 동시 사용: 성능 저하 없이 반응형으로 동작해야 함 [NEEDS CLARIFICATION: 페이지당 항목 수/최대 페이지 범위]
- Import 형식 불일치/필드 누락/중복키: 전체 롤백 또는 부분 적용 정책 필요 [NEEDS CLARIFICATION: 실패 처리 정책]
- 삭제 시 취소를 누른 경우: 아무 변경 없이 이전 상태 유지
- 설정 초기화 필요 시: 기본값 복원 동작 제공 여부 [NEEDS CLARIFICATION: 초기화 버튼 필요 여부]

## Requirements (mandatory)

### Terminology & Consistency
- **고객출처**(질문자 기준): "증권" | "보험". 질문자 데이터에만 적용.
- **상품출처**(상품 기준): "증권" | "보험". 금융상품 데이터와 CoT 질문유형 옵션 제어에 적용.
- **상품분류**: 상품출처에 종속된 카테고리(예: 증권=주식형/채권형/재간접/단기금융/파생형/신탁·퇴직연금, 보험=연금/종신/정기/질병/건강/암/변액).
- **상품유형**: UI 용어 일관화를 위해 "상품분류"로 표준화한다. 기존 문맥의 "상품유형"은 모두 "상품분류"로 표기.
- **질문유형**: 상품출처에 종속된 질문 카테고리(증권=고객 특성 강조형/투자성향 및 조건 기반형/상품비교 추천형, 보험=연령별 및 생애주기 저축성 상품 추천형/투자성 상품 추천형/건강 및 질병 보장 대비형).
- **성별**: "남" | "여". UI 표시는 "남성" | "여성"으로 가능하되 데이터 값은 "남"/"여"로 일관.
- **연령대**: "10대"/"20대"/…/"80대 이상"으로 표준화한다. 기존 "20, 30, …, 80이상" 표현은 모두 표준 연령대 라벨로 매핑.

### Functional Requirements
- **FR-001**: 앱은 로그인 없이 접근 가능해야 한다.
- **FR-002**: 메뉴는 `CoTs`, `설정`, `질문자 리스트`, `상품 리스트`를 제공해야 한다.
- **FR-003**: CoTs 리스트는 텍스트/상품분류/질문유형/질문자 성별/질문자 연령 필터와 검색을 제공해야 한다.
- **FR-004**: CoTs 리스트의 텍스트 검색은 질문, CoT1~n, 답변 본문을 대상으로 해야 한다(대소문자 구분 없음, 부분 일치 허용).
- **FR-005**: CoTs 리스트는 상품분류, 질문유형, 질문자 성별, 질문자 연령대, 질문, 작성자, 등록일, 수정일 컬럼을 표시해야 한다.
- **FR-006**: CoTs 리스트의 항목 클릭 시 상세 페이지로 이동해야 한다.
- **FR-007**: CoTs 상세는 왼쪽/중앙/오른쪽 3패널 레이아웃으로 제공해야 한다.
- **FR-008**: 왼쪽 패널은 질문자 검색/선택 화면을 제공하고 팝업 레이어에서 필터(성별, 연령대) 검색 및 선택 후 상세를 표시해야 한다.
- **FR-009**: 중앙 패널은 상품분류 드롭다운, 질문유형 드롭다운, 질문/CoT1/CoT2/CoT3/CoTn/답변 텍스트 입력, CoT 상태 드롭다운, 작성자 표시를 제공해야 한다.
- **FR-010**: CoT1~3 입력은 필수이며 삭제 불가, CoTn 이후 단계는 추가/삭제 가능해야 한다.
- **FR-011**: 오른쪽 패널은 상품 검색/선택(복수 선택) 기능과 선택 상품의 아코디언 상세 보기를 제공해야 한다.
- **FR-012**: 저장 시 유효성 검사를 수행하고 실패 시 필드별 오류 메시지를 표시해야 한다.
- **FR-013**: 상세 페이지에서 수정/삭제 기능을 제공하고, 삭제는 확인/취소 팝업 후 진행되어야 한다.
- **FR-014**: 설정 화면은 작성자 이름 텍스트, 질문자 수정가능 토글, 상품 수정가능 토글, 글꼴 크기 슬라이더, 라이트/다크 모드 전환을 제공해야 한다.
- **FR-015**: 설정값은 로컬 스토리지에 저장/로드되어야 하며 앱 최초 실행 시 기본값이 적용되어야 한다(기본값: 작성자="관리자" [제안], 질문자/상품 수정가능=ON [제안], 글꼴 크기=기본값, 모드=라이트) [NEEDS CLARIFICATION: 정확한 기본값].
- **FR-016**: 질문자 리스트는 고객출처(증권/보험), 성별(남/여), 연령대(10대~80대 이상) 표시 및 상세 이동을 제공해야 한다.
- **FR-017**: 질문자 상세는 성별, 연령대, 직업, 지역, 가족구성, 자산규모, 투자성향(증권 시)을 표시해야 한다(이름 미표시).
- **FR-018**: 상품 리스트는 상품출처(증권/보험), 상품분류 표시 및 상세 이동을 제공해야 한다.
- **FR-019**: 상품 상세는 상품명, 상품출처, 상품분류, 운용사, 설정수익률, 위험등급을 표시해야 한다.
- **FR-020**: 모든 리스트 화면은 CSV/JSON Import/Export, 검색, 정렬, 페이징을 제공해야 한다.
- **FR-021**: Import 시 필드 검증과 결과 요약(성공 건수, 실패 사유)을 제공해야 한다.
- **FR-022**: 대용량 데이터셋(질문자 30만, 상품 1만, CoT 1만)을 저장/검색/정렬/페이징할 수 있어야 한다.
- **FR-023**: CoT 질문유형/상품출처에 따른 옵션 종속성을 준수해야 한다.
- **FR-024**: 질문자 선택 1명, 상품 선택 1개 이상을 강제해야 한다. [NEEDS CLARIFICATION: 상품 선택 최대 개수 제한 여부]
- **FR-025**: 작성자는 신규 등록 시 설정의 기본 작성자, 수정 시 기존 작성자를 표시해야 한다.
- **FR-026**: 접근성 기본 준수(키보드 탐색, 모드 대비) [NEEDS CLARIFICATION: 적용 기준(예: WCAG 레벨)].
- **FR-027**: 다국어 지원 필요 여부 및 범위 [NEEDS CLARIFICATION: 한국어 전용인지].
- **FR-028**: 시간/날짜 표기 규칙 [NEEDS CLARIFICATION: 로캘/형식/타임존].
- **FR-029**: 삭제 방식 [NEEDS CLARIFICATION: 영구 삭제 vs 복구 가능한 삭제].

### Non-Functional Requirements
- **NFR-001 성능**: 리스트 화면 검색/정렬/페이징 상호작용은 로컬 환경 기준 체감 지연이 최소화되어야 한다. [NEEDS CLARIFICATION: 목표 응답시간 예: 300ms 이내]
- **NFR-002 확장성(데이터량)**: 질문자 30만, 상품 1만, CoT 1만 기준에서 원활히 동작해야 한다. 페이지 크기/가져오기 배치 크기는 조정 가능해야 한다. [NEEDS CLARIFICATION: 기본 페이지 크기]
- **NFR-003 가용성**: 로컬 PC에서 오프라인으로 동작 가능해야 한다(네트워크 연결 불필요).
- **NFR-004 신뢰성**: Import/저장 작업 실패 시 사용자에게 명확한 오류와 재시도 가이드를 제공해야 한다.
- **NFR-005 사용성**: 반응형 UI, 다크/라이트 모드 일관성, 폰트 크기 조절 즉시 반영.
- **NFR-006 접근성**: 키보드 전 영역 조작 가능, 포커스 인디케이터 제공, 명암비 기준 충족. [NEEDS CLARIFICATION]
- **NFR-007 보안/프라이버시**: 익명화 데이터만 취급, 외부 전송 금지, 로컬 저장소 접근은 OS 권한에 따름.
- **NFR-008 데이터 저장**: 브라우저 IndexedDB 활용하여 대용량 데이터를 효율적으로 저장/조회해야 한다. 트랜잭션 지원, 인덱싱을 통한 빠른 검색, 배치 Import/Export 최적화가 포함되어야 한다.

### Business Rules & Policies
- **BR-001 유효성 검사**: 필수 필드(상품출처, 질문유형, 질문자, 상품리스트≥1, 질문, CoT1~3, 답변, CoT 상태)는 미입력 시 저장 불가.
- **BR-002 텍스트 길이**: 질문/CoT/답변 최대 길이 기준을 설정한다. [NEEDS CLARIFICATION: 각 필드 최대 글자 수]
- **BR-003 날짜/시간**: 등록일·수정일은 시스템이 자동 관리한다. [NEEDS CLARIFICATION: 표기 형식]
- **BR-004 정렬 기본값**: 리스트 기본 정렬은 최근 수정일 내림차순을 권장. [NEEDS CLARIFICATION: 확정 필요]
- **BR-005 중복/고유성**: CoT id는 고유해야 하며 중복 시 저장 불가, 사용자에게 안내.
- **BR-006 삭제 정책**: 삭제 전 확인 팝업 필수. [NEEDS CLARIFICATION: 소프트 삭제 여부]
- **BR-007 설정 기본값**: 앱 최초 실행 시 기본값 적용 및 언제든 초기화 가능 여부 결정. [NEEDS CLARIFICATION: 초기화 제공 여부]

### Import/Export Specification
- **형식 공통**: UTF-8, CSV에는 헤더 포함, 구분자는 콤마(,) [NEEDS CLARIFICATION: 다른 구분자 허용 여부]. JSON은 객체/배열 형태.
- **검증**: 필수 컬럼 누락, 데이터 타입 불일치, 사전정의 값 외 입력 시 실패로 처리하고 상세 리포트 제공.
- **미리보기**: Import 전 파싱 결과 요약과 예상 변경사항을 확인할 수 있어야 한다(건수/에러 목록).
- **충돌 처리**: 동일 고유키 발견 시 덮어쓰기/건너뛰기/병합 정책 지정 필요. [NEEDS CLARIFICATION]
- **부분 적용**: 오류 행만 제외하고 유효 행을 적용하거나 전체 롤백 중 선택. [NEEDS CLARIFICATION: 기본 정책]
- **파일 크기**: 단일 Import 최대 파일 크기 제한 설정. [NEEDS CLARIFICATION]
- **배치 처리**: IndexedDB 트랜잭션 최적화를 위해 1000건 단위 배치로 Import 처리. 진행률 표시 및 메모리 사용량 제한.

- **질문자 CSV/JSON 스키마(요약)**
  - 필수: 고객출처, 연령대, 성별
  - 선택: 투자성향(증권 시), 보험가입교차비율(보험 시), 투자액, 보유상품리스트(상품명, 구매년월)
  - 제약: 연령대와 성별은 사전정의 값만 허용

- **금융상품 CSV/JSON 스키마(요약)**
  - 필수: 상품출처, 상품명, 상품분류, 세금유형, 위험등급
  - 선택: 상품 설명, 운용사, 설정수익률
  - 제약: 상품분류/세금유형/위험등급은 사전정의 값만 허용

- **CoT질의응답 CSV/JSON 스키마(요약)**
  - 필수: CoT id, 상품출처, 질문유형, 질문자, 금융상품리스트(≥1), 질문, CoT1, CoT2, CoT3, 답변, 데이터셋 상태
  - 선택: CoTn(여러 단계), 작성자, 등록일, 수정일
  - 제약: 질문유형은 상품출처 종속 규칙을 준수, CoT1~3 필수, CoTn은 0개 이상

### Key Entities (include if feature involves data)
- **질문자(UserAnon)**: 고객출처, 연령대, 성별, 투자성향(증권 시), 보험가입교차비율(보험 시), 투자액, 보유상품리스트(상품명, 구매년월). IndexedDB에 저장되며 성별/연령대/고객출처 인덱스 지원.
- **금융상품(Product)**: 상품출처, 상품명, 상품분류(출처별 카테고리), 세금유형, 상품설명, 위험등급, 운용사, 설정수익률. IndexedDB에 저장되며 상품출처/상품분류/위험등급 인덱스 지원.
- **CoT질의응답(CoTQA)**: CoT id, 상품출처, 질문유형(출처별), 질문자(1명), 금융상품리스트(1개 이상), 질문, CoT1/2/3/n, 답변, 데이터셋 상태, 작성자, 등록일, 수정일. IndexedDB에 저장되며 상품출처/질문유형/상태/질문자 인덱스 지원, 텍스트 검색 최적화.

---

## Review & Acceptance Checklist

### Content Quality
- [ ] 구현 세부 미포함(언어/프레임워크/API 없음)
- [ ] 사용자 가치/비즈니스 요구에 집중
- [ ] 비기술 이해관계자도 이해 가능
- [ ] 모든 필수 섹션 완성

### Requirement Completeness
- [ ] [NEEDS CLARIFICATION] 항목 해소
- [ ] 요구사항이 테스트 가능/일의적
- [ ] 성공 기준이 측정 가능
- [ ] 범위가 명확히 한정됨
- [ ] 의존성과 가정이 식별됨

---

## Execution Status

- [x] User description parsed
- [x] Key concepts extracted
- [x] Ambiguities marked
- [x] User scenarios defined
- [x] Requirements generated
- [x] Entities identified
- [ ] Review checklist passed

---
